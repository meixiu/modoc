## 概述
通过后台来添加和管理数据
前台组织模板和显示参数, 可以对网站进行完全的风格定制
在本机调试需要搭建基础的环境

## 环境搭建
1. 安装nodejs环境:	http://nodejs.cn/
2. 安装自己熟悉的PHP套件, 如 `XMAPP`、`AppServ`
3. 检查环境 `php -v`  `node -v`

## 拉取项目
1. 公共组件库:	http://version.uuzu.com/GTArcade/gta-common.git
2. 后端代码库:  http://version.uuzu.com/GTArcade/gtacms.gtarcade.com.git
3. 前端模板库:	http://version.uuzu.com/GTArcade/gtacms-frontend.git

`公共组件`和`后端代码`为本地运行环境必须, 不需做任何修改和调整
所有的网站参数和模板文件在`前端模板`中

##后台添加新项目
QA环境管理后台: http://qagtacms.gtarcade.com/

1. 通过管理后台新建新项目(如果项目尚未建立)
2. 记录项目ID `siteId`
3. 记录项目对应的游戏ID `gameId` (如果项目为游戏官网)
4. 记录项目域名 `xxx.gtarcade.com`

##前台初始化项目
1. 打开`CMD终端`, 切换到前端项目所在目录:`cd ~/Documents/www/gtacms-frontend/`
2. 首次操作运行 `npm i` 安装依赖模块
3. 执行 `npm run init xxx.gtarcade.com` 初始化项目
4. 成功后在当前目录下会有一个 `xxx.gtarcade.com` 的文件夹
5. 执行 `npm run server xxx.gtarcade.com` 运行项目
6. 在浏览器中打开 `http://localhost:8080` 应该就能看到啦

## 修改网站配置和模板
1. 修改 `xxx.gtarcade.com/params.json` 配置网站相关参数
```
{
  "siteId": 1,
  "gameId": 1,
  "resourceVersion": "20181010"
}
```
2. 修改 `xxx.gtarcade.com/views/*` 配置网站模板



##网站目录结构
- `xxx.gtarcade.com` 
	- `views`	网站模板目录
		- `article.twig`	文章页模板
		- `index.twig`	首页模板
		- `layout.twig`	布局模板
		- `list.twig`		列表页模板
		- `nav.twig`	导航条模板
	- `web`		网站入口文件, 无需做任何修改
	- `params.json`		网站配置参数
	
栏目页模板和内容页模板可以在后台栏目选项里配置成自定义的模板
在项目模板里可以调用放在 `default/views` 里的公共模板:
```
{{ include('@default/footer.twig') }}

{# 或者使用标签 #}
{% include '@default/footer.twig' %}
```

##模板编辑
- 在后台添加栏目, 广告, 文章内容
- 根据前文所述的模板语法,标签,过滤器,函数方法,变量字典组合编辑模板

##在QA服上进行测试
1. 修改hosts `10.18.97.81       xxx.gtarcade.com`
2. 提交 `gtacms-frontend` 代码到服务器
3. 浏览器打开 `http://xxx.gtarcade.com`


